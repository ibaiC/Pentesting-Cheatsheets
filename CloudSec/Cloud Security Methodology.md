# Cloud Security Methodology

# AWS 
Documentation for testing Amazon Web Services.

## Enumeration Framework - Pacu
[https://github.com/RhinoSecurityLabs/pacu](https://github.com/RhinoSecurityLabs/pacu)

### Basic Usage: 
\<insert this eventually> 


## General Config Review

- [ ] Sufficient Password Policy in place
- [ ] MFA Enabled by default?

## Identity and Access Management (IAM)
- [ ] Enumerate policies (`console.aws.amazon.com/iam/home?region=x#/policies`)
	-  Note which policies are customer managed and which are AWS managed.
-  You can click through into the policies to see the `Policy usage`, this provides information on permission grouping.
-  [ ] Check Policy versions. Which is set to default?
-  [ ] Check user access in `console.aws.amazon.com/iam/home?region=x#/users`
	-  Identify potential groups that are overly permissive
	-  Click through into the groups to determine their access levels
-  [ ] Check which users have console access. (*This is shown in the users click through*)
	- Users that have console access
	- [ ] Is MFA enabled when signing in?
- [ ] Enumerate IAM Groups.
	- Note accounts that have:
	- [ ] AdministrativeAccess
- [ ] Enumerate IAM Roles  
	- [ ] Note accounts that have `Trusted Entities` set to `*`
		- This means the role can be assumed by any AWS Resource! 	

### AWS CLI Based Enumeration
Default Setup for AWS CLI
`aws configure`
Prompts for:
- AWS Access Key ID  
- AWS Secret Access Key
- Default region name
- Default output format

#### Enumerate IAM users
`aws iam list-users`
This should return data in the following format
```json
{
	"Path": "/",
	"UserName": "user",
	"UserId": "UID",
	"Arn": "arn ID",
	"CreateData": "Date of Creation"
}
```

#### Enumerate IAM Groups
`aws iam list-groups-for-user --user-name <user>`
Returns data in the following format 

```json
{
	"Groups": [
		{
		"Path": "/",
		"GroupName": "<group name>",
		"GroupId": "<GroupID>",
		"Arn": "<Arn ID>",
		"Creation Date": "<Creation Date>"
		}
	]
}
```

#### Enumerate IAM Inline Policies
`aws iam list-user-policies --user-name <user>`
```json
{
	"PolicyNames":[
	"<Policy Name>"
	]
}
```
also
`aws iam list-attached-user-policies --user-name <user>`

```json
{
	"AttachedPolicies":[
		{
			"PolicyName": "<Policy name>",
			"PolicyArn": "<Policy ARN ID"
		}
	]
}
```

#### Enumerate User's Signing Certificates
`aws iam list-signing-certificates --user-name <user>`
returns as 
```json
{
	"Certificates": [
		{
			"UserName": "<user>",
			"CertificateId": "<CertID>",
			"CertificateBody": "<Certificate Body>",
			"Status": "<Certificate status e.g Active>",
			"UploadDate": "Date Uploaded"
		}
	]
}
```


# Azure


# Google Cloud